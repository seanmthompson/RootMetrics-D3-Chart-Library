!function($){function checkInView(){var $elements=$();if($.each(inviewObjects,function(i,inviewObject){var selector=inviewObject.data.selector,$element=inviewObject.$element;$elements=$elements.add(selector?$element.find(selector):$element)}),$elements.length)for(var i=0;i<$elements.length;i++)if($elements[i])if($.contains(documentElement,$elements[i])){var $el=$($elements[i]),inView=$el.data("inview"),rect=$el[0].getBoundingClientRect(),height=$el.height(),width=$el.width();rect.top>=0-height+yMargin&&rect.left>=0-width+xMargin&&rect.bottom<=(w.innerHeight||documentElement.clientHeight)+height-yMargin&&rect.right<=(w.innerWidth||documentElement.clientWidth)+width-xMargin?inView||$el.data("inview",!0).trigger("inview",[!0]):inView&&$el.data("inview",!1).trigger("inview",[!1])}else delete $elements[i]}var timer,inviewObjects={},d=document,w=window,documentElement=d.documentElement,expando=$.expando,yMargin=-300,xMargin=0;$.event.special.inview={add:function(data){inviewObjects[data.guid+"-"+this[expando]]={data:data,$element:$(this)},timer||$.isEmptyObject(inviewObjects)||(timer=setInterval(checkInView,333))},remove:function(data){try{delete inviewObjects[data.guid+"-"+this[expando]]}catch(e){}$.isEmptyObject(inviewObjects)&&(clearInterval(timer),timer=null)}}}(jQuery);var rmBarChart=function(){"use strict";function chart(selection){cwidth=width-margin.right-margin.left,cheight=height-margin.top-margin.bottom,selection.each(function(data){var div=d3.select(this),$div=$(div[0]);svg=div.selectAll("svg").data([data]),svg.enter().append("svg").call(chart.svgInit),$div.bind("inview",function(event,isInView){isInView&&(animationComplete||(animationComplete=!0,svg.call(chart.animate)))})})}var dataset,svg,barWidth,recWidth,cwidth,cheight,y,yAxis,xAxis,height=400,width=600,addRanks=!1,ticks=5,margin={top:40,right:40,bottom:60,left:40},min=0,max=100,errorBars=!0,animationComplete=!1;return chart.update=function(data){dataset=data,svg.call(chart.animate)},chart.animate=function(svg){barWidth=cwidth/dataset.length,recWidth=barWidth/2;var barContent=svg.select(".bar-content"),bars=barContent.selectAll(".carrier-bar").data(dataset),scores=barContent.selectAll(".scoreText").data(dataset),ranks=barContent.selectAll(".rankText").data(dataset),rankCircles=barContent.selectAll(".rankCircle").data(dataset),errorBar=barContent.selectAll(".error-bar").data(dataset),carrierText=barContent.selectAll(".carrierText").data(dataset),xLines=xAxis.selectAll(".xaxis").data(dataset),upperMax=d3.extent(dataset,function(d){return d.upper})[1];y.domain([min,upperMax]),svg.select(".y.axis").transition().duration(500).call(yAxis),svg.select(".x.axis").attr("transform","translate("+[barWidth,0]+")"),xLines.exit().remove(),xLines.enter().append("line").attr("class","xaxis").attr("transform",function(d,i){return"translate("+i*barWidth+", 0)"}).attr("x1",0).attr("x2",0).attr("y1",0).attr("y2",cheight),xLines.transition().duration(500).attr("class","xaxis").attr("transform",function(d,i){return"translate("+i*barWidth+", 0)"}).attr("x1",0).attr("x2",0).attr("y1",0).attr("y2",cheight),bars.exit().remove(),bars.enter().append("rect").attr("class",function(d){return d.name}).classed("carrier-bar",!0).attr("y",cheight).attr("transform",function(d,i){return"translate("+(i*barWidth+barWidth/2-recWidth/2)+",0)"}).attr("height",0),bars.transition().duration(500).delay(function(d,i){return 100*i}).ease("exp-out").attr("transform",function(d,i){return"translate("+(i*barWidth+barWidth/2-recWidth/2)+",0)"}).attr("height",function(d){return cheight-y(d.score)}).attr("width",recWidth).attr("y",function(d){return y(d.score)}),errorBars&&(errorBar.exit().remove(),errorBar.enter().append("rect").attr("class",function(d){return d.name}).classed("error-bar secondary",!0).attr("width",2).attr("transform",function(d,i){return"translate("+(i*barWidth+barWidth/2)+","+cheight+")"}).attr("height",0),errorBar.transition().duration(500).delay(function(d,i){return 100*i}).ease("exp-out").attr("transform",function(d,i){var upperScale=y(d.upper);return"translate("+(i*barWidth+barWidth/2)+","+upperScale+")"}).attr("height",function(d){var upperScale=y(d.upper),lowerScale=y(d.lower);return lowerScale-upperScale})),carrierText.exit().remove(),carrierText.enter().append("text").style("font-size","12px").attr("class","carrierText").style("fill","#555555").attr("y",cheight+20).style("text-anchor","middle").attr("transform",function(d,i){return"translate("+(i*barWidth+barWidth/2)+",0)"}).text(function(d){return d.name}),carrierText.transition().duration(500).delay(function(d,i){return 100*i}).text(function(d){return d.name}).attr("y",cheight+20).style("text-anchor","middle").attr("transform",function(d,i){return"translate("+(i*barWidth+barWidth/2)+",0)"}),scores.exit().remove(),scores.enter().append("text").attr("class","scoreText").attr("text-anchor","middle").style("fill","#555").style("font-size","12px").attr("transform",function(d,i){return"translate("+(i*barWidth+barWidth/2)+","+cheight+")"}).text(function(d){return d.score}),scores.transition().duration(500).delay(function(d,i){return 100*i}).ease("exp-out").attr("transform",function(d,i){return d.upper?"translate("+(i*barWidth+barWidth/2)+","+(y(d.upper)-5)+")":"translate("+(i*barWidth+barWidth/2)+","+(y(d.score)-5)+")"}).text(function(d){return d.score}),addRanks&&(rankCircles.exit().remove(),rankCircles.enter().append("circle").attr("class","rankCircle").attr("fill",function(d){return 1==d.rank?"#555555":"transparent"}).attr("stroke",function(d){return 1==d.rank?"#555555":"#999999"}).attr("stroke-width","1px").attr("cy",cheight+40).attr("r",10).attr("transform",function(d,i){return"translate("+(i*barWidth+barWidth/2)+",0)"}),rankCircles.attr("class","rankCircle").style("fill",function(d){return 1==d.rank?"#555555":"transparent"}).style("stroke",function(d){return 1==d.rank?"#555555":"#999999"}).transition().duration(500).attr("transform",function(d,i){return"translate("+(i*barWidth+barWidth/2)+",0)"}),ranks.exit().remove(),ranks.enter().append("text").style("font-size","12px").attr("class","rankText").style("fill",function(d){return 1==d.rank?"#FFFFFF":"#555555"}).attr("y",cheight+44).style("text-anchor","middle").attr("transform",function(d,i){return"translate("+(i*barWidth+barWidth/2)+",0)"}).text(function(d,i){return d.rank}),ranks.transition().duration(500).attr("transform",function(d,i){return"translate("+(i*barWidth+barWidth/2)+",0)"}).style("fill",function(d){return 1==d.rank?"#FFFFFF":"#555555"}).text(function(d){return d.rank}))},chart.svgInit=function(svg){svg.attr("width",width).attr("height",height);var g=svg.append("g").attr("class","chart-content").attr("transform","translate("+[margin.left,margin.top]+")");barWidth=cwidth/dataset.length,recWidth=barWidth/2,y=d3.scale.linear().domain([min,max]).range([cheight,0]),yAxis=d3.svg.axis().scale(y).orient("left").ticks(ticks).tickPadding(10).tickSize(-cwidth),g.append("g").attr("class","y axis"),g.select(".y.axis").call(yAxis),xAxis=g.append("g").attr("class","x axis").attr("transform","translate("+[barWidth,0]+")");g.append("g").attr("class","bar-content")},chart.width=function(value){return arguments.length?(width=value,chart):width},chart.height=function(value){return arguments.length?(height=value,chart):height},chart.margin=function(value){return arguments.length?(margin=value,chart):margin},chart.min=function(value){return arguments.length?(min=value,chart):min},chart.max=function(value){return arguments.length?(max=value,chart):max},chart.errorBars=function(value){return arguments.length?(errorBars=value,chart):errorBars},chart.addRanks=function(value){return arguments.length?(ranks=value,chart):ranks},chart.ticks=function(value){return arguments.length?(ticks=value,chart):ticks},chart.dataset=function(value){return arguments.length?(dataset=value,chart):dataset},chart},rmDonutChart=function(){"use strict";function chart(selection){selection.each(function(data){var div=d3.select(this),svg=div.selectAll("svg").data([data]),$div=$(div[0]);svg.enter().append("svg").call(chart.svgInit),$div.bind("inview",function(event,isInView){isInView&&(animationComplete||(animationComplete=!0,svg.call(chart.animate)))})})}function arcTween(transition,newAngle){transition.attrTween("d",function(d){var interpolate=d3.interpolate(d.endAngle,newAngle);return function(t){return d.endAngle=interpolate(t),arc(d)}})}var dataset,foreground,percent,pi,arc,g,margin={top:40,right:40,bottom:40,left:40},height=200,width=200,strokeWidth=15,animationComplete=!1,cwidth=width-margin.right-margin.left,cheight=height-margin.top-margin.bottom;return chart.animate=function(svg){setTimeout(function(){foreground.transition().duration(1e3).ease("elastic").call(arcTween,percent*pi)},200)},chart.svgInit=function(svg){svg.attr("width",width).attr("height",height).attr("class","donut-chart"),cwidth=width-margin.right-margin.left,cheight=height-margin.top-margin.bottom;var radius=Math.min(cwidth,cheight)/2;pi=2*Math.PI,percent=dataset.values/dataset.total,arc=d3.svg.arc().outerRadius(radius).innerRadius(radius-strokeWidth).startAngle(0),g=svg.append("g").attr("transform","translate("+width/2+","+height/2+")");g.append("path").datum({endAngle:pi}).attr("class","donut-background").attr("d",arc);foreground=g.append("path").datum({endAngle:0}).attr("class",function(){return dataset.carrier}).attr("d",arc);svg.append("text").attr("text-anchor","middle").classed("tally",!0).attr("y",height/2).attr("x",width/2).attr("fill","#555").text(dataset.values),svg.append("text").attr("text-anchor","middle").attr("y",height/2+30).attr("x",width/2).attr("class",function(){return"carrier "+dataset.carrier}).text(dataset.carrier)},chart.margin=function(value){return arguments.length?(margin=value,chart):margin},chart.width=function(value){return arguments.length?(width=value,chart):width},chart.height=function(value){return arguments.length?(height=value,chart):height},chart.strokeWidth=function(value){return arguments.length?(strokeWidth=value,chart):strokeWidth},chart.dataset=function(value){return arguments.length?(dataset=value,chart):dataset},chart},rmScatterPlot=function(){"use strict";function chart(selection){selection.each(function(data){var div=d3.select(this),svg=div.selectAll("svg").data([data]),$div=$(div[0]);svg.enter().append("svg").call(chart.svgInit),$div.bind("inview",function(event,isInView){isInView&&(animationComplete||(animationComplete=!0,svg.call(chart.animate)))})})}function showTooltip(d,allDataLookup){tooltip.style("visibility","visible").html(function(){var str="<p><b>"+d.name+"</b></p>";return str+="<p>Reliability: <b>"+d.x.toFixed(1)+"</b></p>",str+="<p>Speed: <b>"+d.y.toFixed(1)+"</b></p>"})}function hideTooltip(){tooltip.style("visibility","hidden")}var dataset,tooltip,margin={top:40,right:40,bottom:40,left:40},radius=7,width=550,min=0,max=100,height=550,xLabel="Speed RootScore",yLabel="Reliability RootScore",animationComplete=!1;width-margin.right-margin.left,height-margin.top-margin.bottom;return chart.animate=function(svg){svg.selectAll(".scatter-dot").transition().duration(750).delay(function(d,i){return 100*i}).ease("elastic").attr("r",radius)},chart.svgInit=function(svg){function zoomed(){g.select(".x.axis").call(xAxis),g.select(".y.axis").call(yAxis),g.selectAll("circle").attr("cx",function(d){return x(d.x)}).attr("cy",function(d){return y(d.y)})}svg.attr("width",width).attr("height",height);var cwidth=width-margin.right-margin.left,cheight=height-margin.top-margin.bottom,g=svg.append("g").attr("class","chart-content").attr("transform","translate("+[margin.left,margin.top]+")"),x=d3.scale.linear().range([0,cwidth]),y=d3.scale.linear().range([cheight,0]),yAxis=d3.svg.axis().scale(y).orient("left").tickSize(-cwidth),xAxis=d3.svg.axis().scale(x).orient("bottom");x.domain([min,max]),y.domain([min,max]);var zoom=d3.behavior.zoom().scaleExtent([1,8]).x(x).y(y).on("zoom",zoomed);svg.call(zoom),svg.on("mousemove",function(){return tooltip.style("top",d3.event.pageY-10+"px").style("left",d3.event.pageX+10+"px")}),g.append("g").attr("class","x axis").call(xAxis).attr("transform","translate(0,"+cheight+")"),g.append("g").attr("class","y axis").call(yAxis),g.selectAll(".scatter-dot").data(dataset).enter().append("circle").attr("class","scatter-dot").attr("r",0).attr("cx",function(d){return x(d.x)}).attr("cy",function(d){return y(d.y)}).on("mouseover",function(d){return showTooltip(d)}).on("mouseout",hideTooltip),tooltip=d3.select("body").append("div").attr("class","tooltip").style("position","absolute").style("visibility","hidden")},chart.width=function(value){return arguments.length?(width=value,chart):width},chart.height=function(value){return arguments.length?(height=value,chart):height},chart.radius=function(value){return arguments.length?(radius=value,chart):radius},chart.margin=function(value){return arguments.length?(margin=value,chart):margin},chart.min=function(value){return arguments.length?(min=value,chart):min},chart.max=function(value){return arguments.length?(max=value,chart):max},chart.xLabel=function(value){return arguments.length?(xLabel=value,chart):xLabel},chart.yLabel=function(value){return arguments.length?(yLabel=value,chart):yLabel},chart.dataset=function(value){return arguments.length?(dataset=value,chart):dataset},chart},rmDoubleBarChart=function(){"use strict";function chart(selection){cwidth=width-margin.right-margin.left,cheight=height-margin.top-margin.bottom,selection.each(function(data){var div=d3.select(this),$div=$(div[0]);svg=div.selectAll("svg").data([data]),svg.enter().append("svg").call(chart.svgInit),$div.bind("inview",function(event,isInView){isInView&&(animationComplete||(animationComplete=!0,svg.call(chart.animate)))})})}var dataset,svg,max,yAxis,barWidth,recWidth,y,height=400,width=600,margin={top:60,right:40,bottom:40,left:40},errorBars=!0,min=0,ticks=5,animationComplete=!1,cwidth=width-margin.right-margin.left,cheight=height-margin.top-margin.bottom;return chart.update=function(data){dataset=data,svg.call(chart.animate)},chart.animate=function(svg){var barContent=svg.select(".bar-content"),bars=barContent.selectAll(".carrier-bar")[0],scores=barContent.selectAll(".scoreText")[0],errorBottom=barContent.selectAll(".error-bar-bottom")[0],errorTop=barContent.selectAll(".error-bar-top")[0],errorBar=barContent.selectAll(".error-bar")[0],counter=0;svg.select(".y.axis").call(yAxis),$.each(dataset,function(index,v){var multiplier=recWidth*index;$.each(v,function(i,val){d3.select(bars[counter]).transition().duration(500).delay(function(){return 100*counter}).ease("exp-out").attr("y",function(d){return y(val.score)}).attr("height",function(){return cheight-y(val.score)}),d3.select(scores[counter]).transition().duration(500).delay(function(){return 100*counter}).ease("exp-out").attr("transform",function(d,iterator){return"translate("+(i*barWidth+barWidth/2-recWidth/2+multiplier)+","+(y(val.upper)-7)+")"}).text(function(d){return+val.score.toFixed(1)}),d3.select(errorBottom[counter]).transition().duration(500).delay(function(){return 100*counter}).ease("exp-out").attr("transform",function(d,iterator){return"translate("+(i*barWidth+barWidth/2-recWidth+multiplier+recWidth/v.length)+","+y(val.lower)+")"}),d3.select(errorTop[counter]).transition().duration(500).delay(function(){return 100*counter}).ease("exp-out").attr("transform",function(d,iterator){return"translate("+(i*barWidth+barWidth/2-recWidth+multiplier+recWidth/v.length)+","+y(val.upper)+")"}),d3.select(errorBar[counter]).transition().duration(500).delay(function(){return 100*counter}).ease("exp-out").attr("transform",function(d,iterator){return"translate("+(i*barWidth+barWidth/2-recWidth/2+multiplier)+","+y(val.upper)+")"}).attr("height",function(d){var upperScale=y(val.upper),lowerScale=y(val.lower);return lowerScale-upperScale}),counter++})})},chart.svgInit=function(svg){svg.attr("width",width).attr("height",height);var g=svg.append("g").attr("class","chart-content").attr("transform","translate("+[margin.left,margin.top]+")");max||(max=0,$.each(dataset,function(i,v){$.each(v,function(ind,val){val.upper>max&&(max=val.upper)})})),barWidth=cwidth/dataset[0].length,recWidth=barWidth/dataset[0].length,y=d3.scale.linear().domain([min,max]).range([cheight,0]),yAxis=d3.svg.axis().scale(y).orient("left").ticks(ticks).tickPadding(10).tickSize(-cwidth),g.append("g").attr("class","y axis"),g.select(".y.axis").call(yAxis);var xAxis=g.append("g").attr("class","x axis").attr("transform","translate("+[barWidth,0]+")");xAxis.selectAll(".xaxis").data(dataset[0]).enter().append("line").attr("class","xaxis").attr("transform",function(d,i){return"translate("+i*barWidth+", 0)"}).attr("x1",0).attr("x2",0).attr("y1",0).attr("y2",cheight);var bars=g.append("g").attr("class","bar-content");bars.selectAll(".carrierText").data(dataset[0]).enter().append("text").style("font-size","12px").attr("class","carrierText").style("fill","#555555").attr("y",cheight+20).style("text-anchor","middle").attr("transform",function(d,i){return"translate("+(i*barWidth+barWidth/2)+", 0)"}).text(function(d){return d.name}),$.each(dataset,function(index,v){var multiplier=recWidth*index;$.each(v,function(i,val){bars.append("rect").attr("class",function(d){return val.name}).classed("carrier-bar",!0).style("opacity",function(){return 0==index?.5:1}).attr("height",0).attr("y",function(d){return cheight}).attr("width",recWidth).attr("transform",function(d,iterator){return"translate("+(i*barWidth+barWidth/2-recWidth+multiplier)+",0)"}),errorBars&&(bars.append("rect").attr("class",function(d){return val.name}).classed("error-bar secondary",!0).attr("width",2).attr("transform",function(d,iterator){y(val.upper);return"translate("+(i*barWidth+barWidth/2-recWidth/2+multiplier)+","+cheight+")"}).attr("height",function(d){var upperScale=y(val.upper),lowerScale=y(val.lower);return lowerScale-upperScale}),bars.append("rect").attr("class","error-bar-top").attr("height",1).attr("width",recWidth/2).attr("transform",function(d,iterator){y(val.upper);return"translate("+(i*barWidth+barWidth/2-recWidth+multiplier+recWidth/v.length)+","+cheight+")"}).style("display","none"),bars.append("rect").attr("class","error-bar-bottom").attr("height",1).attr("width",recWidth/2).attr("transform",function(d,iterator){y(val.lower);return"translate("+(i*barWidth+barWidth/2-recWidth+multiplier+recWidth/v.length)+","+cheight+")"}).style("display","none")),bars.append("text").attr("class","scoreText").attr("text-anchor","middle").style("fill","#555").style("alignment-baseline","baseline").style("font-size","12px").text(function(d){return+val.score.toFixed(1)}).attr("transform",function(d,iterator){return"translate("+(i*barWidth+barWidth/2-recWidth/2+multiplier)+","+cheight+")"})})})},chart.width=function(value){return arguments.length?(width=value,chart):width},chart.height=function(value){return arguments.length?(height=value,chart):height},chart.margin=function(value){return arguments.length?(margin=value,chart):margin},chart.min=function(value){return arguments.length?(min=value,chart):min},chart.max=function(value){return arguments.length?(max=value,chart):max},chart.ticks=function(value){return arguments.length?(ticks=value,chart):ticks},chart.errorBars=function(value){return arguments.length?(errorBars=value,chart):errorBars},chart.dataset=function(value){return arguments.length?(dataset=value,chart):dataset},chart},rmHrDoubleBarChart=function(){function chart(selection){cwidth=width-margin.right-margin.left,cheight=height-margin.top-margin.bottom,selection.each(function(data){var div=d3.select(this),$div=$(div[0]);svg=div.selectAll("svg").data([data]),svg.enter().append("svg").call(chart.svgInit),$div.bind("inview",function(event,isInView){isInView&&(animationComplete||(animationComplete=!0,svg.call(chart.animate)))})})}var dataset,svg,cwidth,cheight,x,height=400,width=600,margin={top:20,right:20,bottom:20,left:20},errorBars=!0,min=0,max=0,barHeight=30,barPadding=50,animationComplete=!1;return chart.update=function(data){dataset=data,svg.call(chart.animate)},chart.animate=function(svg){var barContent=svg.select(".bar-content"),bars=barContent.selectAll(".carrier-bar")[0],ties=barContent.selectAll(".carrier-ties")[0],scores=barContent.selectAll(".scoreText")[0],counter=0;$.each(dataset,function(index,v){$.each(v,function(i,val){d3.select(bars[counter]).transition().duration(500).delay(function(){return 100*counter}).ease("exp-out").attr("width",x(val.wins+val.ties)),d3.select(ties[counter]).transition().duration(500).delay(function(){return 100*counter}).ease("exp-out").attr("width",x(val.ties)),d3.select(scores[counter]).transition().duration(500).delay(function(){return 100*counter}).ease("exp-out").attr("x",x(val.wins+val.ties)+85).text(val.wins+val.ties),counter++})})},chart.svgInit=function(svg){height=dataset[0].length*(barHeight+barPadding)+margin.top+margin.bottom,svg.attr("width",width).attr("height",height);var g=svg.append("g").attr("class","chart-content").attr("transform","translate("+[margin.left,margin.top]+")");$.each(dataset,function(index,value){$.each(value,function(i,v){var higher=v.ties+v.wins;max=higher>max?higher:max})});d3.scale.ordinal().domain([0,max]).rangeBands([0,cwidth]);x=d3.scale.linear().domain([min,max]).range([0,cwidth-margin.right-margin.left-75]),svg.append("defs").append("pattern").attr("id","diagonalHatch").attr("patternUnits","userSpaceOnUse").attr("width",7).attr("height",7).attr("patternTransform","rotate(45 0 0)").append("line").attr("x1","0").attr("y1","0").attr("x2","0").attr("y2","7").attr("stroke","#ffffff").attr("stroke-width",2),svg.append("line").attr("class","x axis").attr("x1",margin.left+75).attr("x2",margin.left+75).attr("y1",0).attr("y2",height).style("stroke","#555555").style("stroke-width",2);var bars=g.append("g").attr("class","bar-content");bars.selectAll(".carrierText").data(dataset[0]).enter().append("text").attr("class","carrierText").style("fill","#555555").attr("y",function(d,i){return i*(barHeight+barPadding)+barHeight+5}).attr("x",28).attr("text-anchor","end").text(function(d){return d.name}),$.each(dataset,function(index,v){var multiplier=barHeight*index;$.each(v,function(i,val){bars.append("rect").attr("class",function(d){return val.name}).classed("carrier-bar",!0).style("opacity",function(){return 0==index?.5:1}).attr("height",barHeight).attr("y",function(){return i*(barHeight+barPadding)+multiplier}).attr("x",75).attr("width",0),bars.append("rect").classed("carrier-ties",!0).attr("fill","url(#diagonalHatch)").style("opacity",.5).attr("height",barHeight).attr("x",75).attr("y",i*(barHeight+barPadding)+multiplier).attr("width",0),bars.append("text").attr("class","scoreText").style("fill","#555555").attr("y",function(){return i*(barHeight+barPadding)+multiplier+20}).attr("x",75).text(val.wins+val.ties)})})},chart.width=function(value){return arguments.length?(width=value,chart):width},chart.margin=function(value){return arguments.length?(margin=value,chart):margin},chart.min=function(value){return arguments.length?(min=value,chart):min},chart.max=function(value){return arguments.length?(max=value,chart):max},chart.errorBars=function(value){return arguments.length?(errorBars=value,chart):errorBars},chart.barHeight=function(value){return arguments.length?(barHeight=value,chart):barHeight},chart.barPadding=function(value){return arguments.length?(barPadding=value,chart):barPadding},chart.dataset=function(value){return arguments.length?(dataset=value,chart):dataset},chart},rmHrBarChart=function(){function chart(selection){cwidth=width-margin.right-margin.left,cheight=height-margin.top-margin.bottom,selection.each(function(data){var div=d3.select(this),$div=$(div[0]);svg=div.selectAll("svg").data([data]),svg.enter().append("svg").call(chart.svgInit),$div.bind("inview",function(event,isInView){isInView&&(animationComplete||(animationComplete=!0,svg.call(chart.animate)))})})}var dataset,svg,xAxis,barWidth,cwidth,cheight,x,y,height=400,width=600,ranks=!1,margin={top:20,right:20,bottom:20,left:20},errorBars=!0,min=0,max=0,threshold=!1,ticks=5,barHeight=30,barPadding=50,addXAxis=!1,animationComplete=!1;return chart.update=function(data){dataset=data,svg.call(chart.animate)},chart.animate=function(svg){var barContent=svg.select(".bar-content"),bars=barContent.selectAll(".carrier-bar"),scores=barContent.selectAll(".scoreText"),ranks=barContent.selectAll(".rankText"),rankCircles=barContent.selectAll(".rankCircle"),errorBar=barContent.selectAll(".error-bar"),carrierText=barContent.selectAll(".carrierText");bars.data(dataset).attr("class",function(d){return d.name}).classed("carrier-bar",!0).transition().duration(500).delay(function(d,i){return 100*i}).ease("exp-out").attr("width",function(d){return x(d.score)}),carrierText.data(dataset).text(function(d){return d.name}),scores.data(dataset).transition().duration(500).delay(function(d,i){return 100*i}).ease("exp-out").attr("x",cwidth).text(function(d){return threshold&&d.score.toFixed(1)<=0?"*":d.score.toFixed(1)}),errorBar.data(dataset).attr("class",function(d){return d.name}).classed("error-bar secondary",!0).transition().duration(500).delay(function(d,i){return 100*i}).ease("exp-out").attr("transform",function(d,i){var lowerScale=x(d.lower);return"translate("+(lowerScale+90)+","+i*(barHeight+barPadding)+")"}).attr("width",function(d){var upperScale=x(d.upper),lowerScale=x(d.lower);return upperScale-lowerScale}),ranks&&(rankCircles.data(dataset).attr("class","rankCircle").style("fill",function(d){return 1==d.rank?"#555555":"transparent"}).style("stroke",function(d){return 1==d.rank?"#555555":"#999999"}).style("display",function(d){return threshold&&d.score.toFixed(1)<=0?"none":void 0}),ranks.data(dataset).style("fill",function(d){return 1==d.rank?"#FFFFFF":"#555555"}).text(function(d){return threshold&&d.score.toFixed(1)<=0?"":d.rank}))},chart.svgInit=function(svg){height=dataset.length*(barHeight+barPadding)+margin.top+margin.bottom,barWidth=cwidth/dataset.length,recWidth=barWidth/dataset.length,svg.attr("width",width).attr("height",height);var g=svg.append("g").attr("class","chart-content").attr("transform","translate("+[margin.left,margin.top]+")");$.each(dataset,function(index,v){var higher=v.upper;max=higher>max?higher:max}),y=d3.scale.ordinal().domain([0,max]).rangeBands([0,cwidth]),x=d3.scale.linear().domain([min,max]).range([0,cwidth-margin.right-margin.left-75]),addXAxis&&(xAxis=d3.svg.axis().scale(x).orient("bottom").ticks(ticks).tickPadding(10).tickSize(5),g.append("g").attr("class","x axis").attr("transform","translate(90,"+(dataset.length*(barHeight+barPadding)-barPadding)+")"),g.select(".x.axis").call(xAxis));var bars=g.append("g").attr("class","bar-content");bars.selectAll("rect").data(dataset).enter().append("rect").attr("class",function(d){return d.name}).classed("carrier-bar",!0).attr("height",barHeight).attr("y",function(d,i){return i*(barHeight+barPadding)-barHeight/2}).attr("x",90).attr("width",0),errorBars&&bars.selectAll(".error-bar").data(dataset).enter().append("rect").attr("class",function(d){return d.name}).classed("error-bar secondary",!0).attr("height",2).attr("transform",function(d,i){return"translate(0,"+i*(barHeight+barPadding)+")"}).attr("width",0),bars.selectAll(".scoreText").data(dataset).enter().append("text").attr("class","scoreText").attr("text-anchor","end").style("fill","#555").style("font-size","12px").attr("y",function(d,i){return i*(barHeight+barPadding)+4}).attr("x",0).text(function(d){return threshold&&d.score.toFixed(1)<=0?"":d.score.toFixed(1)}),bars.selectAll(".carrierText").data(dataset).enter().append("text").style("font-size","12px").attr("class","carrierText").style("fill","#555555").attr("y",function(d,i){return i*(barHeight+barPadding)+4}).attr("x",28).text(function(d){return d.name}),ranks&&(bars.selectAll(".rankCircle").data(dataset).enter().append("circle").attr("class","rankCircle").style("fill",function(d){return 1==d.rank?"#555555":"transparent"}).style("stroke",function(d){return 1==d.rank?"#555555":"#999999"}).attr("stroke-width","1px").attr("r",10).attr("cx",11).attr("cy",function(d,i){return i*(barHeight+barPadding)}).attr("style",function(d){return threshold&&d.score.toFixed(1)<=0?"display: none":void 0}),bars.selectAll(".rankText").data(dataset).enter().append("text").style("font-size","12px").attr("class","rankText").attr("x",11).style("fill",function(d){return 1==d.rank?"#FFFFFF":"#555555"}).attr("text-anchor","middle").attr("y",function(d,i){return i*(barHeight+barPadding)+5}).text(function(d){return threshold&&d.score.toFixed(1)<=0?"":d.rank}))},chart.width=function(value){return arguments.length?(width=value,chart):width},chart.margin=function(value){return arguments.length?(margin=value,chart):margin},chart.min=function(value){return arguments.length?(min=value,chart):min},chart.max=function(value){return arguments.length?(max=value,chart):max},chart.errorBars=function(value){return arguments.length?(errorBars=value,chart):errorBars},chart.barHeight=function(value){return arguments.length?(barHeight=value,chart):barHeight},chart.barPadding=function(value){return arguments.length?(barPadding=value,chart):barPadding},chart.ranks=function(value){return arguments.length?(ranks=value,chart):ranks},chart.threshold=function(value){return arguments.length?(threshold=value,chart):threshold},chart.addXAxis=function(value){return arguments.length?(addXAxis=value,chart):addXAxis},chart.ticks=function(value){return arguments.length?(ticks=value,chart):ticks},chart.dataset=function(value){return arguments.length?(dataset=value,chart):dataset},chart};
//# sourceMappingURL=rm-chart-library.min.js.map